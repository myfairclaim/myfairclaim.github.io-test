<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyFairClaim Product Flow - Visual Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #374151 0%, #6b7280 100%);
            padding: 40px 20px;
            line-height: 1.6;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
        }
        
        /* Desktop zoom only */
        @media (min-width: 1024px) {
            body {
                zoom: 0.64;
            }
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 50px;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
                border-radius: 8px;
            }
        }
        
        h1 {
            color: #6b7280;
            margin-bottom: 20px;
            font-size: 48px;
            text-align: center;
            background: linear-gradient(135deg, #374151 0%, #6b7280 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            text-align: center;
            color: #6b7280;
            font-size: 18px;
            margin-bottom: 60px;
        }
        
        h2 {
            color: #374151;
            margin: 80px 0 40px;
            font-size: 36px;
            border-left: 6px solid #6b7280;
            padding-left: 20px;
        }
        
        /* Main Flow Steps */
        .flow-container {
            margin: 50px 0;
        }
        
        .flow-step {
            background: white;
            border: 4px solid #e5e7eb;
            border-radius: 16px;
            padding: 40px;
            margin: 30px 0;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .flow-step:hover {
            border-color: #6b7280;
            box-shadow: 0 8px 24px rgba(30, 58, 138, 0.2);
            transform: translateY(-4px);
        }
        
        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #6b7280 0%, #6b7280 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: bold;
            margin-right: 20px;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(30, 58, 138, 0.4);
        }
        
        .step-title {
            font-size: 28px;
            font-weight: 700;
            color: #1f2937;
        }
        
        .step-description {
            color: #6b7280;
            font-size: 16px;
            line-height: 1.8;
            margin-left: 80px;
        }
        
        .arrow-down {
            text-align: center;
            font-size: 48px;
            color: #6b7280;
            margin: 20px 0;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* Tier Comparison */
        .tier-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin: 40px 0;
        }
        
        .tier-card {
            background: white;
            border: 4px solid;
            border-radius: 16px;
            padding: 40px 30px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .tier-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.15);
        }
        
        .tier-essential {
            border-color: #6b7280;
            background: linear-gradient(135deg, #ffffff 0%, #f9fafb 100%);
        }
        
        .tier-professional {
            border-color: #6b7280;
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
        }
        
        .tier-premium {
            border-color: #10b981;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
        }
        
        .tier-name {
            font-size: 14px;
            font-weight: 700;
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .tier-essential .tier-name {
            background: #6b7280;
        }
        
        .tier-professional .tier-name {
            background: #6b7280;
        }
        
        .tier-premium .tier-name {
            background: #10b981;
        }
        
        .tier-price {
            font-size: 48px;
            font-weight: 700;
            margin: 20px 0;
        }
        
        .tier-essential .tier-price {
            color: #374151;
        }
        
        .tier-professional .tier-price {
            color: #1e40af;
        }
        
        .tier-premium .tier-price {
            color: #065f46;
        }
        
        .tier-items {
            text-align: left;
            margin: 30px 0;
        }
        
        .tier-item {
            padding: 12px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            font-size: 15px;
        }
        
        .tier-item::before {
            content: '‚úì';
            color: #10b981;
            font-weight: bold;
            font-size: 20px;
            margin-right: 12px;
            background: #d1fae5;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .tier-item.disabled {
            opacity: 0.3;
            text-decoration: line-through;
        }
        
        /* Timeline */
        .timeline {
            position: relative;
            padding: 40px 0;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(180deg, #6b7280 0%, #6b7280 100%);
            transform: translateX(-50%);
        }
        
        .timeline-item {
            position: relative;
            margin: 60px 0;
            display: flex;
            align-items: center;
        }
        
        .timeline-item:nth-child(odd) {
            flex-direction: row;
        }
        
        .timeline-item:nth-child(even) {
            flex-direction: row-reverse;
        }
        
        .timeline-content {
            flex: 0 0 45%;
            background: white;
            border: 4px solid #e5e7eb;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .timeline-content:hover {
            border-color: #6b7280;
            transform: scale(1.05);
            box-shadow: 0 8px 24px rgba(30, 58, 138, 0.3);
        }
        
        .timeline-dot {
            flex: 0 0 10%;
            display: flex;
            justify-content: center;
            z-index: 10;
        }
        
        .timeline-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6b7280 0%, #6b7280 100%);
            border: 6px solid white;
            box-shadow: 0 0 0 4px #6b7280;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 28px;
        }
        
        .timeline-spacer {
            flex: 0 0 45%;
        }
        
        .timeline-date {
            font-weight: 700;
            color: #6b7280;
            font-size: 20px;
            margin-bottom: 10px;
        }
        
        .timeline-title {
            font-size: 22px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 12px;
        }
        
        .timeline-desc {
            color: #6b7280;
            font-size: 15px;
            line-height: 1.6;
        }
        
        /* Highlight Box */
        .highlight-box {
            background: linear-gradient(135deg, #f0fdf4 0%, #d1fae5 100%);
            border-left: 6px solid #10b981;
            border-radius: 12px;
            padding: 30px;
            margin: 40px 0;
        }
        
        .highlight-box h3 {
            color: #065f46;
            margin-bottom: 15px;
            font-size: 24px;
        }
        
        .highlight-box p {
            color: #047857;
            font-size: 16px;
            line-height: 1.8;
        }
        
        /* Path Branches */
        .path-container {
            margin: 50px 0;
        }
        
        .path-split {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin-top: 40px;
        }
        
        .path-box {
            background: white;
            border: 4px solid;
            border-radius: 12px;
            padding: 30px;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .path-box::before {
            content: '';
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 40px;
        }
        
        .path-box:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(30, 58, 138, 0.15);
        }
        
        .path-essential {
            border-color: #6b7280;
        }
        
        .path-essential::before {
            background: #6b7280;
        }
        
        .path-professional {
            border-color: #6b7280;
        }
        
        .path-professional::before {
            background: #6b7280;
        }
        
        .path-premium {
            border-color: #10b981;
        }
        
        .path-premium::before {
            background: #10b981;
        }
        
        .path-icon {
            font-size: 48px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .path-title {
            font-size: 20px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 15px;
            color: #1f2937;
        }
        
        .path-desc {
            color: #6b7280;
            font-size: 14px;
            text-align: center;
            line-height: 1.6;
        }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .tier-grid {
                grid-template-columns: 1fr;
            }
            
            .path-split {
                grid-template-columns: 1fr;
            }
            
            .timeline-item {
                flex-direction: column !important;
            }
            
            .timeline-content, .timeline-spacer {
                flex: 1 1 100% !important;
            }
            
            .timeline::before {
                left: 40px;
            }
        }
        
        /* Mobile specific */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 32px;
            }
            
            h2 {
                font-size: 24px;
                margin: 40px 0 20px;
            }
            
            .step-number {
                width: 50px;
                height: 50px;
                font-size: 22px;
            }
            
            .step-title {
                font-size: 20px;
            }
            
            .step-description {
                margin-left: 0;
                margin-top: 15px;
            }
            
            .tier-price {
                font-size: 36px;
            }
            
            .timeline-circle {
                width: 60px;
                height: 60px;
                font-size: 22px;
            }
            
            .timeline-date {
                font-size: 16px;
            }
            
            .timeline-title {
                font-size: 18px;
            }
            
            /* Stack header info on mobile */
            div[style*="display: flex"] {
                flex-direction: column !important;
                gap: 15px;
            }
            
            /* Make footer single column on mobile */
            div[style*="grid-template-columns: repeat(3"] {
                display: block !important;
            }
            
            div[style*="grid-template-columns: repeat(3"] > div {
                margin-bottom: 20px;
            }
            
            /* Legend grid to single column on mobile */
            div[style*="grid-template-columns: repeat(2"] {
                grid-template-columns: 1fr !important;
            }
        }
        
        /* Print Styles for PDF Export */
        @media print {
            @page {
                size: letter; /* 8.5in x 11in */
                margin: 0.75in;
            }
            
            body {
                background: white;
                padding: 0;
                zoom: 1 !important;
            }
            
            .container {
                box-shadow: none;
                border-radius: 0;
                padding: 20px;
                max-width: 100%;
            }
            
            .print-button {
                display: none !important;
            }
            
            /* Section headings */
            h1 {
                page-break-after: avoid;
                font-size: 32pt;
            }
            
            h2 {
                page-break-after: avoid;
                page-break-before: auto;
                margin-top: 24pt;
                font-size: 24pt;
            }
            
            h3 {
                page-break-after: avoid;
                margin-top: 16pt;
                font-size: 18pt;
            }
            
            /* Keep important sections together */
            .flow-step {
                page-break-inside: avoid;
                border: 2px solid #e5e7eb;
                box-shadow: none;
            }
            
            .tier-card {
                page-break-inside: avoid;
            }
            
            .path-box {
                page-break-inside: avoid;
            }
            
            .timeline-item {
                page-break-inside: avoid;
            }
            
            /* Tables */
            table {
                page-break-inside: avoid;
                font-size: 10pt;
            }
            
            /* Code blocks */
            code {
                background: #f1f5f9;
            }
            
            /* Ensure colors print */
            * {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            /* Hide hover effects */
            .flow-step:hover {
                transform: none;
                box-shadow: none;
            }
            
            /* Simplify gradients for print */
            div[style*="background: linear-gradient"] {
                background: #374151 !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- MFC Branding Header -->
        <div style="background: linear-gradient(135deg, #374151 0%, #6b7280 100%); padding: 40px 20px; border-radius: 12px; margin-bottom: 40px; text-align: center;">
            <img src="https://myfairclaim.github.io/logo.png" alt="MyFairClaim" style="display: block; margin: 0 auto 20px; border: 0; height: auto; max-width: 240px; width: 100%;">
            <div style="color: #dbeafe; font-size: 15px; font-style: italic; padding: 0 10px;">
                "They fixed the car. Not the history. You shouldn't pay the difference."
            </div>
            
            <!-- Print/PDF Button -->
            <button class="print-button" onclick="window.print()" style="
                margin-top: 25px;
                background: white;
                color: #374151;
                border: none;
                padding: 12px 30px;
                border-radius: 8px;
                font-size: 15px;
                font-weight: 600;
                cursor: pointer;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                transition: all 0.3s ease;
            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 16px rgba(0,0,0,0.2)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'">
                üìÑ Export to PDF / Print
            </button>
        </div>
        
        <h1>MyFairClaim Product Flow</h1>
        <p class="subtitle">Complete Customer Journey & Developer Implementation Guide</p>
        
        <div style="background: #f8fafc; border-left: 4px solid #6b7280; padding: 20px; border-radius: 8px; margin-bottom: 40px;">
            <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 15px;">
                <div style="flex: 1; min-width: 200px;">
                    <div style="font-weight: 700; color: #374151; font-size: 16px;">Product Flow & Implementation Guide</div>
                    <div style="color: #6b7280; font-size: 14px; margin-top: 5px;">Customer Journey + Developer Technical Specifications</div>
                </div>
                <div style="text-align: right; font-size: 13px; color: #6b7280;">
                    <div>Document Version 1.0</div>
                    <div>December 30, 2024</div>
                </div>
            </div>
        </div>
        
        <!-- Color Legend -->
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 40px;">
            <div style="background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-left: 4px solid #10b981; padding: 20px; border-radius: 8px;">
                <div style="font-weight: 700; color: #065f46; margin-bottom: 8px;">üë§ Customer Experience</div>
                <div style="color: #047857; font-size: 14px;">What customers see and experience at each step</div>
            </div>
            <div style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-left: 4px solid #6b7280; padding: 20px; border-radius: 8px;">
                <div style="font-weight: 700; color: #1f2937; margin-bottom: 8px;">‚öôÔ∏è Developer Implementation</div>
                <div style="color: #475569; font-size: 14px;">Technical requirements, APIs, database operations</div>
            </div>
        </div>
        
        <!-- Brevo Templates Reference -->
        <div style="background: #eff6ff; border-left: 6px solid #3b82f6; padding: 30px; border-radius: 12px; margin-bottom: 40px;">
            <h3 style="color: #1e40af; margin: 0 0 15px 0; font-size: 22px;">üìß Pre-Loaded Brevo Email Templates</h3>
            <div style="color: #1e3a8a; line-height: 1.8;">
                All email templates are pre-loaded in Brevo and triggered via API or automation workflows. Templates use contact attributes for personalization.<br><br>
                
                <strong>Welcome Emails (Purchase):</strong><br>
                ‚Ä¢ Template #1: Essential_Email_REDESIGNED_V5<br>
                ‚Ä¢ Template #2: Professional_Email_REDESIGNED_V5<br>
                ‚Ä¢ Template #3: Premium_Email_REDESIGNED_V5<br><br>
                
                <strong>Upsell Emails (Automated Workflows):</strong><br>
                ‚Ä¢ Template #4: Upgrade_To_Professional_Email_Template<br>
                ‚Ä¢ Template #5: Upgrade_To_Premium_Email_Template<br><br>
                
                <strong>Renewal Emails (Automated Workflows):</strong><br>
                ‚Ä¢ Template #7: 30_Day_Warning_Template<br>
                ‚Ä¢ Template #8: 7_Day_Urgent_Warning_Template<br>
                ‚Ä¢ Template #9: Access_Expired_Template<br>
                ‚Ä¢ Template #10: Renewal_Confirmation_Template<br><br>
                
                <strong>Upgrade Confirmation Emails (Purchase):</strong><br>
                ‚Ä¢ Template #11: Upgrade_To_Professional (Essential‚ÜíProfessional)<br>
                ‚Ä¢ Template #12: Upgrade_To_Premium (Essential/Professional‚ÜíPremium)
            </div>
        </div>
        
        <!-- MAIN PURCHASE FLOW -->
        <h2>üì¶ Purchase & Delivery Flow</h2>
        
        <div class="flow-container">
            <div class="flow-step">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Purchase & PDF Delivery</div>
                </div>
                <div class="step-description">
                    Customer enters vehicle/claim data, completes payment through Stripe, then receives calculated results and downloads personalized PDF reports.
                    <div style="background: #f0fdf4; padding: 20px; border-radius: 8px; margin-top: 20px; border-left: 4px solid #10b981;">
                        <strong style="color: #065f46;">üë§ Customer Experience:</strong><br>
                        <div style="margin-top: 10px; line-height: 2; color: #047857;">
                            ‚Ä¢ Enters vehicle and claim details on myfairclaim.com<br>
                            ‚Ä¢ Selects tier: Essential ($49.99), Professional ($149.99), or Premium ($249.99)<br>
                            ‚Ä¢ Completes Stripe checkout<br>
                            ‚Ä¢ Redirected to success page displaying calculated DV amount and vehicle values<br>
                            ‚Ä¢ Downloads LossIntel & VehicleIntel PDF reports immediately<br>
                            ‚Ä¢ Receives Stripe payment confirmation email
                        </div>
                    </div>
                    <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #6b7280;">
                        <strong style="color: #1f2937;">‚öôÔ∏è Developer Implementation:</strong><br>
                        <div style="margin-top: 10px; line-height: 2;">
                            <strong>Stripe Checkout Setup:</strong><br>
                            ‚Ä¢ Collect: <code>customer_email</code>, <code>firstname</code>, <code>lastname</code>, <code>vin</code>, <code>vehicle_year</code>, <code>make</code>, <code>model</code>, <code>mileage</code>, <code>accident_date</code>, <code>repair_cost</code><br>
                            ‚Ä¢ Add all form data to Stripe session metadata<br>
                            ‚Ä¢ Selected tier determines checkout amount<br><br>
                            
                            <strong>Post-Payment Success Page:</strong><br>
                            ‚Ä¢ Calculate DV values using Enhanced DV methodology:<br>
                            &nbsp;&nbsp;&nbsp;¬∞ <code>dv_amount</code> = calculation result<br>
                            &nbsp;&nbsp;&nbsp;¬∞ <code>pre_accident_value</code> = market analysis<br>
                            &nbsp;&nbsp;&nbsp;¬∞ <code>post_accident_value</code> = pre_accident_value - dv_amount<br>
                            ‚Ä¢ Generate tier-specific PDFs with customer data + calculated values<br>
                            ‚Ä¢ Display results and provide download links<br>
                            ‚Ä¢ Website stores nothing (stateless)<br><br>
                            
                            <strong>Metadata Strategy:</strong><br>
                            Backend needs calculated values. Choose one approach:<br>
                            ‚Ä¢ <strong>Option A:</strong> Update Stripe metadata post-calculation with DV values<br>
                            ‚Ä¢ <strong>Option B:</strong> Backend recalculates from form inputs (requires same DV logic)
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="arrow-down">‚¨áÔ∏è</div>
            
            <div class="flow-step">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Backend Processing (Triggered by Stripe Webhook)</div>
                </div>
                <div class="step-description">
                    Stripe webhook receives metadata and triggers backend processing. System obtains DV values, generates PDFs for email, creates access tokens, and stores all data in database.
                    <div style="background: #f0fdf4; padding: 20px; border-radius: 8px; margin-top: 20px; border-left: 4px solid #10b981;">
                        <strong style="color: #065f46;">üë§ Customer Experience:</strong><br>
                        <div style="margin-top: 10px; line-height: 2; color: #047857;">
                            ‚Ä¢ Transparent background processing happens automatically<br>
                            ‚Ä¢ Professional/Premium: System generates unique 90-day access token<br>
                            ‚Ä¢ All purchase data saved for playbook pre-population and communications<br>
                            ‚Ä¢ Welcome email arrives within 2-5 minutes with full access details<br>
                            &nbsp;&nbsp;(Template #1: Essential | Template #2: Professional | Template #3: Premium)
                        </div>
                    </div>
                    <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #6b7280;">
                        <strong style="color: #1f2937;">‚öôÔ∏è Developer Implementation:</strong><br>
                        <div style="margin-top: 10px; line-height: 2;">
                            <strong>Webhook Receives:</strong><br>
                            ‚Ä¢ Event: <code>checkout.session.completed</code><br>
                            ‚Ä¢ Extract ALL data from Stripe metadata object<br><br>
                            
                            <strong>Processing Sequence:</strong><br>
                            1. <strong>Obtain DV Values:</strong><br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Extract from Stripe metadata if included (Option A)<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Or recalculate from form inputs using Enhanced DV methodology (Option B)<br><br>
                            
                            2. <strong>Generate PDFs</strong> from metadata + DV values (~15-20 sec):<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Create <code>LossIntel_[tier].pdf</code> + <code>VehicleIntel_[tier].pdf</code><br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Required for Brevo email attachment<br><br>
                            
                            3. <strong>Create access token</strong> (Professional/Premium only):<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ <code>token = random_bytes(32) + HMAC_SHA256(secret)</code> ‚Üí 64 chars<br><br>
                            
                            4. <strong>Build playbook URLs:</strong><br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Professional: <code>CFG_URL</code> only<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Premium: <code>CFG_URL + IRG_URL + IDG_URL</code><br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Format: <code>https://tools.myfairclaim.com/[tool]?token={token}</code><br><br>
                            
                            5. <strong>Database operations</strong> (~2-3 sec):<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ <code>INSERT INTO playbook_access</code> (email, tier, access_token, purchase_date, expiration_date=NOW()+90 days, is_active=1, VIN, vehicle data, calculated values, ...)<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ <code>INSERT INTO transaction_log</code> (email, type='purchase', tier, amount, stripe_session_id, metadata, ...)<br><br>
                            
                            <strong>Performance Target:</strong> <30 seconds total
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="arrow-down">‚¨áÔ∏è</div>
            
            <div class="flow-step">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Welcome Email via Brevo Templates</div>
                </div>
                <div class="step-description">
                    Backend triggers tier-specific Brevo email template with customer data. Pre-loaded templates automatically populate with contact attributes and send with PDF attachments.
                    <div style="background: #f0fdf4; padding: 20px; border-radius: 8px; margin-top: 20px; border-left: 4px solid #10b981;">
                        <strong style="color: #065f46;">üë§ Customer Experience:</strong><br>
                        <div style="margin-top: 10px; line-height: 2; color: #047857;">
                            ‚Ä¢ Receives personalized welcome email within 2-5 minutes<br>
                            &nbsp;&nbsp;(Template #1: Essential | Template #2: Professional | Template #3: Premium)<br>
                            ‚Ä¢ Email addressed by first name with tier-specific messaging<br>
                            ‚Ä¢ LossIntel & VehicleIntel PDFs attached for convenient email access<br>
                            ‚Ä¢ Professional/Premium: Clickable playbook links with 90-day expiration clearly stated<br>
                            ‚Ä¢ Support contact info and next steps included<br>
                            ‚Ä¢ 98%+ inbox delivery rate
                        </div>
                    </div>
                    <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #6b7280;">
                        <strong style="color: #1f2937;">‚öôÔ∏è Developer Implementation:</strong><br>
                        <div style="margin-top: 10px; line-height: 2;">
                            <strong>Brevo API:</strong> <code>POST https://api.brevo.com/v3/smtp/email</code><br>
                            Headers: <code>api-key: YOUR_KEY</code>, <code>Content-Type: application/json</code><br><br>
                            
                            <strong>Trigger Pre-Loaded Template:</strong><br>
                            ‚Ä¢ Essential: Brevo Template #1 (Essential_Email_REDESIGNED_V5)<br>
                            ‚Ä¢ Professional: Brevo Template #2 (Professional_Email_REDESIGNED_V5)<br>
                            ‚Ä¢ Premium: Brevo Template #3 (Premium_Email_REDESIGNED_V5)<br>
                            ‚Ä¢ Templates already loaded in Brevo with design/content<br>
                            ‚Ä¢ API call populates template variables with customer data<br><br>
                            
                            <strong>Contact Attributes (18 total):</strong><br>
                            <code>FIRSTNAME</code>, <code>LASTNAME</code>, <code>TIER</code>, <code>VIN</code>, <code>VEHICLE_YEAR</code>, <code>VEHICLE_MAKE</code>, <code>VEHICLE_MODEL</code>, <code>CURRENT_MILEAGE</code>, <code>DV_AMOUNT</code>, <code>PRE_ACCIDENT_VALUE</code>, <code>POST_ACCIDENT_VALUE</code>, <code>REPAIR_COST</code>, <code>PURCHASE_DATE</code>, <code>EXPIRATION_DATE</code>, <code>ACCESS_TOKEN</code>, <code>CFG_URL</code>, <code>IRG_URL</code>, <code>IDG_URL</code><br><br>
                            
                            <strong>List Assignment:</strong> Essential‚ÜíList #2 | Professional‚ÜíList #3 | Premium‚ÜíList #4<br><br>
                            
                            <strong>PDF Attachments:</strong><br>
                            ‚Ä¢ Attach generated PDFs (from Step 2) as base64-encoded files<br>
                            ‚Ä¢ Provides email-based access to reports
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="arrow-down">‚¨áÔ∏è</div>
            
            <div class="flow-step">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">Customer Accesses Playbooks</div>
                </div>
                <div class="step-description">
                    Customer clicks playbook link from email. System validates token, checks expiration/tier, then grants or denies access with pre-populated data.
                    <div style="background: #f0fdf4; padding: 20px; border-radius: 8px; margin-top: 20px; border-left: 4px solid #10b981;">
                        <strong style="color: #065f46;">üë§ Customer Experience:</strong><br>
                        <div style="margin-top: 10px; line-height: 2; color: #047857;">
                            ‚Ä¢ Clicks playbook link from welcome email<br>
                            ‚Ä¢ Playbook loads instantly with all their data pre-filled (VIN, vehicle details, DV amount, etc.)<br>
                            ‚Ä¢ No login required - secure token in URL grants access<br>
                            ‚Ä¢ Can access playbooks unlimited times within 90-day window<br>
                            ‚Ä¢ Professional: Claim Filing Guide | Premium: CFG + IRG + IDG<br>
                            ‚Ä¢ If expired: Sees "Access Expired" page with extension offer
                        </div>
                    </div>
                    <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #6b7280;">
                        <strong style="color: #1f2937;">‚öôÔ∏è Developer Implementation:</strong><br>
                        <div style="margin-top: 10px; line-height: 2;">
                            <strong>Token Validation Flow:</strong><br>
                            1. Extract <code>token</code> from URL: <code>?token={64_char_string}</code><br>
                            2. Query: <code>SELECT * FROM playbook_access WHERE access_token=?</code><br>
                            3. Validate:<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Token exists? ‚Üí NO: Return HTTP 404 "Invalid token"<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ <code>is_active=1</code>? ‚Üí NO: Return HTTP 403 "Deactivated"<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ <code>expiration_date >= NOW()</code>? ‚Üí NO: Return HTTP 410 "Expired"<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Tier allows playbook? ‚Üí NO: Return HTTP 403 "Upgrade required"<br>
                            4. If valid:<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Increment <code>access_count++</code><br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Update <code>last_accessed_at=NOW()</code><br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Inject all 18 attributes into playbook HTML<br>
                            &nbsp;&nbsp;&nbsp;‚Ä¢ Return HTTP 200 with pre-populated playbook<br><br>
                            
                            <strong>Tier Access Control:</strong><br>
                            Professional: CFG only | Premium: CFG + IRG + IDG
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- TIER COMPARISON -->
        <h2>üéØ What Each Tier Receives</h2>
        
        <div class="tier-grid">
            <div class="tier-card tier-essential">
                <div class="tier-name">ESSENTIAL</div>
                <div class="tier-price">$49.99</div>
                <div style="text-align: center; margin-bottom: 25px; color: #6b7280; font-size: 14px;">
                    Reports Only ‚Ä¢ Best for DIY filers
                </div>
                <div class="tier-items">
                    <div class="tier-item">LossIntel PDF Report</div>
                    <div class="tier-item">VehicleIntel PDF Report</div>
                    <div class="tier-item disabled">Claim Filing Guide</div>
                    <div class="tier-item disabled">Insurance Response Guide</div>
                    <div class="tier-item disabled">Insurance Dispute Guide</div>
                </div>
                <div style="margin-top: 25px; background: #f9fafb; padding: 15px; border-radius: 8px; text-align: left;">
                    <div style="font-size: 13px; color: #6b7280; line-height: 1.8;">
                        <strong>üîß Implementation:</strong><br>
                        Template #1 | List #2<br>
                        No <code>ACCESS_TOKEN</code><br>
                        Upsells: Day 3, 7<br>
                        Extension: $24.99<br><br>
                        <strong>üë§ Customer Gets:</strong><br>
                        Professional PDF reports ready to submit to insurance
                    </div>
                </div>
            </div>
            
            <div class="tier-card tier-professional">
                <div class="tier-name">PROFESSIONAL</div>
                <div class="tier-price">$149.99</div>
                <div style="text-align: center; margin-bottom: 25px; color: #1e40af; font-size: 14px; font-weight: 600;">
                    ‚≠ê Most Popular ‚Ä¢ Reports + Filing Guide
                </div>
                <div class="tier-items">
                    <div class="tier-item">LossIntel PDF Report</div>
                    <div class="tier-item">VehicleIntel PDF Report</div>
                    <div class="tier-item">Claim Filing Guide</div>
                    <div class="tier-item disabled">Response Playbook</div>
                    <div class="tier-item disabled">Insurance Dispute Guide</div>
                </div>
                <div style="margin-top: 25px; background: #eff6ff; padding: 15px; border-radius: 8px; text-align: left;">
                    <div style="font-size: 13px; color: #6b7280; line-height: 1.8;">
                        <strong>üîß Implementation:</strong><br>
                        Template #2 | List #3<br>
                        Generates <code>ACCESS_TOKEN</code><br>
                        Access: <code>CFG_URL</code> only<br>
                        Upsell: Day 5<br>
                        Extension: $74.99<br><br>
                        <strong>üë§ Customer Gets:</strong><br>
                        PDFs + interactive tool to file claim professionally with state laws & templates
                    </div>
                </div>
            </div>
            
            <div class="tier-card tier-premium">
                <div class="tier-name">PREMIUM</div>
                <div class="tier-price">$249.99</div>
                <div style="text-align: center; margin-bottom: 25px; color: #065f46; font-size: 14px; font-weight: 600;">
                    üèÜ Complete Suite
                </div>
                <div class="tier-items">
                    <div class="tier-item">LossIntel PDF Report</div>
                    <div class="tier-item">VehicleIntel PDF Report</div>
                    <div class="tier-item">Claim Filing Guide</div>
                    <div class="tier-item">Insurance Response Guide</div>
                    <div class="tier-item">Insurance Dispute Guide</div>
                </div>
                <div style="margin-top: 25px; background: #f0fdf4; padding: 15px; border-radius: 8px; text-align: left;">
                    <div style="font-size: 13px; color: #065f46; line-height: 1.8;">
                        <strong>üîß Implementation:</strong><br>
                        Template #3 | List #4<br>
                        Generates <code>ACCESS_TOKEN</code><br>
                        Access: All 3 URLs (CFG, IRG, IDG)<br>
                        No upsells<br>
                        Extension: $124.99<br><br>
                        <strong>üë§ Customer Gets:</strong><br>
                        PDFs + complete toolkit: file claim, handle insurance response, resolve disputes
                    </div>
                </div>
            </div>
        </div>
        
        <div class="highlight-box">
            <h3>üîê All Tiers Include:</h3>
            <p>
                ‚Ä¢ <strong>Professional PDF reports</strong> - LossIntel & VehicleIntel with valuation analysis<br>
                ‚Ä¢ <strong>Immediate download</strong> from website after purchase completion<br>
                ‚Ä¢ <strong>Email delivery</strong> within 2-5 minutes with PDF attachments for convenient access<br>
                ‚Ä¢ <strong>Pre-populated vehicle and claim data</strong> in playbooks (Professional & Premium)<br>
                ‚Ä¢ <strong>Secure access with unique tokens</strong> - cryptographically secure 64-character keys<br>
                ‚Ä¢ <strong>Unlimited playbook access</strong> during 90-day window (no additional charges)<br>
                ‚Ä¢ <strong>Email support</strong> throughout access period<br>
                ‚Ä¢ <strong>50% discount on extensions</strong> - offered at Day 60 and Day 83<br>
                ‚Ä¢ <strong>Data privacy</strong> - all information encrypted and securely stored in backend database
            </p>
        </div>
        
        <!-- UPSELL JOURNEY -->
        <h2>üìà Automated Upsell Journey</h2>
        
        <div class="path-container">
            <div style="text-align: center; font-size: 20px; color: #6b7280; margin-bottom: 30px;">
                After initial purchase, customers receive targeted upgrade offers
            </div>
            
            <div class="arrow-down">‚¨áÔ∏è</div>
            
            <div class="path-split">
                <div class="path-box path-essential">
                    <div class="path-icon">üìä</div>
                    <div class="path-title">Essential Path</div>
                    <div class="path-desc">
                        <strong>Day 3:</strong> Brevo Workflow #1 triggers Template #4<br>
                        <strong>Day 7:</strong> Brevo Workflow #2 triggers Template #5
                    </div>
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e5e7eb; font-size: 13px; color: #6b7280;">
                        <strong>Brevo Templates (Pre-Loaded):</strong><br>
                        Template #4: Upgrade_To_Professional_Email_Template<br>
                        Template #5: Upgrade_To_Premium_Email_Template<br><br>
                        
                        <strong>Automation Workflows:</strong><br>
                        Workflow #1: List #2 (Essential) ‚Üí Wait 3 days ‚Üí Send Template #4<br>
                        Workflow #2: List #2 (Essential) ‚Üí Wait 7 days ‚Üí Send Template #5<br><br>
                        <strong>Exit Condition:</strong> If <code>TIER</code> attribute changes, remove from workflow
                    </div>
                </div>
                
                <div class="path-box path-professional">
                    <div class="path-icon">üìò</div>
                    <div class="path-title">Professional Path</div>
                    <div class="path-desc">
                        <strong>Day 5:</strong> Brevo Workflow #3 triggers Template #5<br><br>
                        Highlights Insurance Response & Dispute Guides for complete claim support
                    </div>
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e5e7eb; font-size: 13px; color: #6b7280;">
                        <strong>Brevo Template (Pre-Loaded):</strong><br>
                        Template #5: Upgrade_To_Premium_Email_Template<br><br>
                        
                        <strong>Automation Workflow:</strong><br>
                        Workflow #3: List #3 (Professional) ‚Üí Wait 5 days ‚Üí Send Template #5<br><br>
                        <strong>Exit Condition:</strong> If <code>TIER</code> = "Premium", stop workflow
                    </div>
                </div>
                
                <div class="path-box path-premium">
                    <div class="path-icon">üèÜ</div>
                    <div class="path-title">Premium Path</div>
                    <div class="path-desc">
                        <strong>No upsell workflows</strong><br><br>
                        Customer already has complete suite. Skip to renewal automation.
                    </div>
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e5e7eb; font-size: 13px; color: #6b7280;">
                        <strong>Brevo Automation Setup:</strong><br>
                        Contact in List #4 (Premium) - no upsell workflows<br>
                        Only triggered workflows: Renewal sequence (Workflows #4, #5, #6)
                    </div>
                </div>
            </div>
        </div>
        
        <!-- RENEWAL TIMELINE -->
        <!-- UPGRADE FLOW -->
        <h2>üîÑ Upgrade Purchase Flow (Essential‚ÜíPro, Essential‚ÜíPremium, Pro‚ÜíPremium)</h2>
        
        <div style="background: #fef9c3; border-left: 6px solid #eab308; padding: 30px; border-radius: 12px; margin: 40px 0;">
            <h3 style="color: #713f12; margin: 0 0 20px 0; font-size: 22px;">Customer Upgrades to Higher Tier</h3>
            
            <div style="background: #f0fdf4; padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #10b981;">
                <strong style="color: #065f46;">üë§ Customer Experience:</strong><br>
                <div style="margin-top: 10px; line-height: 2; color: #047857;">
                    ‚Ä¢ Receives upsell email with upgrade link (Day 3, 5, or 7 depending on tier)<br>
                    &nbsp;&nbsp;(Template #4: Essential‚ÜíPro | Template #5: Essential/Pro‚ÜíPremium)<br>
                    ‚Ä¢ Clicks link and completes Stripe checkout for upgrade price ($100 or $200)<br>
                    ‚Ä¢ Immediately gains access to new playbooks (no waiting)<br>
                    ‚Ä¢ Receives upgrade confirmation email with new playbook links<br>
                    &nbsp;&nbsp;(Template #11: Professional upgrade | Template #12: Premium upgrade)<br>
                    ‚Ä¢ Original 90-day expiration remains unchanged (no time lost)<br>
                    ‚Ä¢ All previous data and reports remain accessible
                </div>
            </div>
            
            <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <strong style="color: #1f2937;">‚öôÔ∏è Stripe Webhook: Upgrade Purchase</strong><br>
                <div style="margin-top: 10px; line-height: 2;">
                    <strong>Event:</strong> <code>checkout.session.completed</code><br>
                    <strong>Metadata Required:</strong><br>
                    ‚Ä¢ <code>transaction_type</code> = "upgrade"<br>
                    ‚Ä¢ <code>customer_email</code> (string)<br>
                    ‚Ä¢ <code>old_tier</code> (Essential|Professional)<br>
                    ‚Ä¢ <code>new_tier</code> (Professional|Premium)<br>
                    ‚Ä¢ <code>upgrade_price</code> (100.00 or 200.00)
                </div>
            </div>
            
            <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <strong style="color: #1f2937;">‚öôÔ∏è Backend Processing Sequence:</strong><br>
                <div style="margin-top: 10px; line-height: 2;">
                    1. <strong>Query Existing Record:</strong><br>
                    &nbsp;&nbsp;&nbsp;<code>SELECT * FROM playbook_access WHERE email = ?</code><br><br>
                    
                    2. <strong>Generate New Token (if needed):</strong><br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ If Essential‚ÜíProfessional OR Essential‚ÜíPremium: Generate <code>ACCESS_TOKEN</code><br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ If Professional‚ÜíPremium: Keep existing token (already has CFG access)<br><br>
                    
                    3. <strong>Update Database:</strong><br>
                    &nbsp;&nbsp;&nbsp;<code>UPDATE playbook_access SET</code><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>tier = ?,</code> (new tier)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>access_token = ?,</code> (new token if applicable, else keep existing)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>updated_at = NOW()</code><br>
                    &nbsp;&nbsp;&nbsp;<code>WHERE email = ?</code><br><br>
                    
                    4. <strong>Log Transaction:</strong><br>
                    &nbsp;&nbsp;&nbsp;<code>INSERT INTO transaction_log</code><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>(email, transaction_type, tier, amount, stripe_session_id, metadata, created_at)</code><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>VALUES (?, 'upgrade', ?, ?, ?, ?, NOW())</code><br><br>
                    
                    5. <strong>Build Playbook URLs (if new token generated):</strong><br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ Essential‚ÜíProfessional: CFG_URL only<br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ Essential‚ÜíPremium: CFG_URL + IRG_URL + IDG_URL<br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ Professional‚ÜíPremium: IRG_URL + IDG_URL (CFG_URL unchanged)
                </div>
            </div>
            
            <div style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <strong style="color: #1f2937;">Brevo API Updates:</strong><br>
                <div style="margin-top: 10px; line-height: 2;">
                    1. <strong>Update Contact Attributes:</strong><br>
                    &nbsp;&nbsp;&nbsp;<code>PUT /v3/contacts/{email}</code><br>
                    &nbsp;&nbsp;&nbsp;Update: <code>TIER</code>, <code>ACCESS_TOKEN</code> (if new), <code>CFG_URL</code>, <code>IRG_URL</code>, <code>IDG_URL</code><br><br>
                    
                    2. <strong>Move Contact Between Lists:</strong><br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ Remove from old list: <code>DELETE /v3/contacts/lists/{old_list_id}/contacts/remove</code><br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ Add to new list: <code>POST /v3/contacts/lists/{new_list_id}/contacts/add</code><br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ Essential (List #2) ‚Üí Professional (List #3)<br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ Essential (List #2) ‚Üí Premium (List #4)<br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ Professional (List #3) ‚Üí Premium (List #4)<br><br>
                    
                    3. <strong>Trigger Brevo Upgrade Confirmation Template:</strong><br>
                    &nbsp;&nbsp;&nbsp;<code>POST /v3/smtp/email</code><br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ <strong>Pre-Loaded Templates in Brevo:</strong><br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Template #11: Upgrade_To_Professional (for Essential‚ÜíProfessional)<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Template #12: Upgrade_To_Premium (for Essential‚ÜíPremium or Professional‚ÜíPremium)<br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ Templates populated with contact attributes and new playbook access links<br>
                    &nbsp;&nbsp;&nbsp;‚Ä¢ PDFs not re-attached (customer already has them)
                </div>
            </div>
            
            <div style="background: white; padding: 20px; border-radius: 8px;">
                <strong style="color: #1f2937;">Critical Rules:</strong><br>
                <div style="margin-top: 10px; line-height: 2; color: #dc2626;">
                    ‚Ä¢ ‚ùå Do NOT generate new PDFs (customer already has them)<br>
                    ‚Ä¢ ‚ùå Do NOT change <code>purchase_date</code> or <code>expiration_date</code> (90 days continues from original)<br>
                    ‚Ä¢ ‚úÖ DO preserve existing <code>access_count</code> and usage data<br>
                    ‚Ä¢ ‚úÖ DO move contact to new list to stop old upsell workflows<br>
                    ‚Ä¢ ‚úÖ DO update all playbook URLs in Brevo (even if only adding new ones)
                </div>
            </div>
        </div>
        
        <!-- IMPLEMENTATION NOTE -->
        <div style="background: #fef2f2; border-left: 6px solid #ef4444; padding: 30px; border-radius: 12px; margin: 40px 0;">
            <h3 style="color: #991b1b; margin: 0 0 15px 0; font-size: 22px;">‚öôÔ∏è Implementation: Stateless Website & Metadata</h3>
            <div style="color: #7f1d1d; line-height: 1.8;">
                The website operates statelessly with no database. All transaction data flows through Stripe metadata to the backend webhook.<br><br>
                
                <strong>Stripe Metadata Requirements:</strong><br>
                ‚Ä¢ Customer details: <code>email</code>, <code>firstname</code>, <code>lastname</code><br>
                ‚Ä¢ Vehicle information: <code>vin</code>, <code>year</code>, <code>make</code>, <code>model</code>, <code>mileage</code><br>
                ‚Ä¢ Claim data: <code>accident_date</code>, <code>repair_cost</code><br>
                ‚Ä¢ Purchase: <code>tier</code> (Essential|Professional|Premium)<br><br>
                
                <strong>Calculated Values Strategy:</strong><br>
                Website calculates DV values post-payment on success page. Backend needs these values for database and emails.<br><br>
                
                <strong>Option A:</strong> Update Stripe session metadata with <code>dv_amount</code>, <code>pre_accident_value</code>, <code>post_accident_value</code> after calculation<br>
                <strong>Option B:</strong> Backend recalculates using same Enhanced DV methodology from form inputs
            </div>
        </div>
        
        <h2>üîÑ 90-Day Access & Renewal Timeline</h2>
        
        <div class="timeline">
            <div class="timeline-item">
                <div class="timeline-content">
                    <div class="timeline-date">Day 0</div>
                    <div class="timeline-title">Purchase Complete</div>
                    <div class="timeline-desc">
                        <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #10b981;">
                            <strong style="color: #065f46;">üë§ Customer Experience:</strong><br>
                            <div style="margin-top: 8px; line-height: 1.8; color: #047857; font-size: 14px;">
                                ‚Ä¢ Completes Stripe payment and immediately sees DV calculation results<br>
                                ‚Ä¢ Downloads LossIntel & VehicleIntel PDF reports from website<br>
                                ‚Ä¢ Receives welcome email within 2-5 minutes with PDFs and playbook links<br>
                                &nbsp;&nbsp;(Template #1: Essential | Template #2: Professional | Template #3: Premium)<br>
                                ‚Ä¢ Professional/Premium: Can immediately access interactive tools<br>
                                ‚Ä¢ 90-day access period begins from purchase date<br>
                                ‚Ä¢ All vehicle and claim data pre-populated in playbooks
                            </div>
                        </div>
                        
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px; border-left: 4px solid #6b7280;">
                            <strong style="color: #1f2937;">‚öôÔ∏è Developer Implementation:</strong><br>
                            <div style="margin-top: 8px; line-height: 1.8; font-size: 14px;">
                                <strong>Database Record Created:</strong><br>
                                ‚Ä¢ <code>INSERT INTO playbook_access</code> with purchase_date = NOW()<br>
                                ‚Ä¢ <code>expiration_date</code> = NOW() + 90 days<br>
                                ‚Ä¢ Professional/Premium: Generate and store ACCESS_TOKEN<br><br>
                                
                                <strong>Brevo Contact Created:</strong><br>
                                ‚Ä¢ Added to appropriate list (Essential #2, Professional #3, Premium #4)<br>
                                ‚Ä¢ All 18 contact attributes populated<br>
                                ‚Ä¢ PURCHASE_DATE and EXPIRATION_DATE set for renewal workflows
                            </div>
                        </div>
                    </div>
                </div>
                <div class="timeline-dot">
                    <div class="timeline-circle">0</div>
                </div>
                <div class="timeline-spacer"></div>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-spacer"></div>
                <div class="timeline-dot">
                    <div class="timeline-circle">60</div>
                </div>
                <div class="timeline-content">
                    <div class="timeline-date">Day 60</div>
                    <div class="timeline-title">30-Day Warning Email</div>
                    <div class="timeline-desc">
                        <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #10b981;">
                            <strong style="color: #065f46;">üë§ Customer Experience:</strong><br>
                            <div style="margin-top: 8px; line-height: 1.8; color: #047857; font-size: 14px;">
                                ‚Ä¢ Receives friendly email reminder that access expires in 30 days (Template #7)<br>
                                ‚Ä¢ Sees 50% discount offer for 90-day extension<br>
                                ‚Ä¢ One-click renewal link goes directly to Stripe checkout<br>
                                ‚Ä¢ Pricing: Essential $24.99, Professional $74.99, Premium $124.99<br>
                                ‚Ä¢ No pressure - just a helpful heads-up
                            </div>
                        </div>
                        
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px; border-left: 4px solid #6b7280;">
                            <strong style="color: #1f2937;">‚öôÔ∏è Developer Implementation:</strong><br>
                            <div style="margin-top: 8px; line-height: 1.8; font-size: 14px;">
                                <strong>Brevo Template (Pre-Loaded):</strong><br>
                                Template #7: 30_Day_Warning_Template<br><br>
                                
                                <strong>Workflow Trigger:</strong><br>
                                Workflow #4: <code>EXPIRATION_DATE</code> - 30 days ‚Üí Send Template #7<br><br>
                                
                                <strong>Template Parameters:</strong><br>
                                ‚Ä¢ <code>params.tier</code> = Customer's tier<br>
                                ‚Ä¢ <code>params.expirationDate</code> = From <code>EXPIRATION_DATE</code> attribute<br>
                                ‚Ä¢ <code>params.renewalPrice</code> = 50% of original price<br>
                                &nbsp;&nbsp;(Essential: $24.99, Professional: $74.99, Premium: $124.99)<br>
                                ‚Ä¢ <code>params.renewalLink</code> = Stripe checkout URL for extension
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-content">
                    <div class="timeline-date">Day 83</div>
                    <div class="timeline-title">7-Day Urgent Warning</div>
                    <div class="timeline-desc">
                        <div style="background: #fef9c3; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #eab308;">
                            <strong style="color: #713f12;">üë§ Customer Experience:</strong><br>
                            <div style="margin-top: 8px; line-height: 1.8; color: #854d0e; font-size: 14px;">
                                ‚Ä¢ Receives urgent (but not pushy) reminder - only 7 days left (Template #8)<br>
                                ‚Ä¢ Same 50% discount still available<br>
                                ‚Ä¢ Final opportunity messaging without high pressure<br>
                                ‚Ä¢ Easy one-click renewal to avoid losing access<br>
                                ‚Ä¢ Emphasizes convenience of keeping all tools active
                            </div>
                        </div>
                        
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px; border-left: 4px solid #6b7280;">
                            <strong style="color: #1f2937;">‚öôÔ∏è Developer Implementation:</strong><br>
                            <div style="margin-top: 8px; line-height: 1.8; font-size: 14px;">
                                <strong>Brevo Template (Pre-Loaded):</strong><br>
                                Template #8: 7_Day_Urgent_Warning_Template<br><br>
                                
                                <strong>Workflow Trigger:</strong><br>
                                Workflow #5: <code>EXPIRATION_DATE</code> - 7 days ‚Üí Send Template #8<br><br>
                                
                                <strong>Template Parameters:</strong> Same as Day 60<br>
                                ‚Ä¢ <code>params.tier</code>, <code>params.expirationDate</code>, <code>params.renewalPrice</code>, <code>params.renewalLink</code><br><br>
                                <strong>Condition:</strong> Only send if customer hasn't renewed (check <code>EXPIRATION_DATE</code> hasn't been updated)
                            </div>
                        </div>
                    </div>
                </div>
                <div class="timeline-dot">
                    <div class="timeline-circle">83</div>
                </div>
                <div class="timeline-spacer"></div>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-spacer"></div>
                <div class="timeline-dot">
                    <div class="timeline-circle" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">91</div>
                </div>
                <div class="timeline-content" style="border-color: #ef4444;">
                    <div class="timeline-date" style="color: #ef4444;">Day 91</div>
                    <div class="timeline-title">Access Expired</div>
                    <div class="timeline-desc">
                        <div style="background: #fef2f2; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #ef4444;">
                            <strong style="color: #991b1b;">üë§ Customer Experience:</strong><br>
                            <div style="margin-top: 8px; line-height: 1.8; color: #b91c1c; font-size: 14px;">
                                ‚Ä¢ Playbook links no longer work (see "Access Expired" message)<br>
                                ‚Ä¢ Receives understanding email - no shame or pressure (Template #9)<br>
                                ‚Ä¢ Can still reactivate anytime at same 50% discount<br>
                                ‚Ä¢ All their data remains saved and ready<br>
                                ‚Ä¢ Easy reactivation process with one click<br>
                                ‚Ä¢ PDF reports remain accessible (downloaded previously)
                            </div>
                        </div>
                        
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px; border-left: 4px solid #6b7280;">
                            <strong style="color: #1f2937;">‚öôÔ∏è Developer Implementation:</strong><br>
                            <div style="margin-top: 8px; line-height: 1.8; font-size: 14px;">
                                <strong>Brevo Template (Pre-Loaded):</strong><br>
                                Template #9: Access_Expired_Template<br><br>
                                
                                <strong>Technical Behavior:</strong><br>
                                ‚Ä¢ Database check: <code>expiration_date</code> < NOW()<br>
                                ‚Ä¢ Token validation returns HTTP 410 "Gone"<br>
                                ‚Ä¢ Playbook URLs show "Access Expired" page<br><br>
                                
                                <strong>Workflow Trigger:</strong><br>
                                Workflow #6: <code>EXPIRATION_DATE</code> + 1 day ‚Üí Send Template #9<br>
                                Parameters: Same as Day 60/83 (reactivation link)<br><br>
                                
                                <strong>Note:</strong> Token still exists in database with <code>is_active</code>=1, just expired
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-content" style="border-color: #10b981;">
                    <div class="timeline-date" style="color: #10b981;">Any Time</div>
                    <div class="timeline-title">Extension Purchased</div>
                    <div class="timeline-desc">
                        <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #10b981;">
                            <strong style="color: #065f46;">üë§ Customer Experience:</strong><br>
                            <div style="margin-top: 8px; line-height: 1.8; color: #047857; font-size: 14px;">
                                ‚Ä¢ Completes Stripe checkout for extension (50% discount)<br>
                                ‚Ä¢ Playbook access immediately reactivated (if expired) or extended (if active)<br>
                                ‚Ä¢ Receives confirmation email with new expiration date (Template #10)<br>
                                ‚Ä¢ Gets full 90 days from extension date (no time lost if renewing early)<br>
                                ‚Ä¢ All data, reports, and playbooks remain accessible<br>
                                ‚Ä¢ New 30-day and 7-day warnings scheduled automatically
                            </div>
                        </div>
                        
                        <div style="background: #f8fafc; padding: 15px; border-radius: 8px; border-left: 4px solid #6b7280;">
                            <strong style="color: #1f2937;">‚öôÔ∏è Developer Implementation:</strong><br>
                            <div style="margin-top: 8px; line-height: 1.8; font-size: 14px;">
                                <strong>Brevo Template (Pre-Loaded):</strong><br>
                                Template #10: Renewal_Confirmation_Template<br><br>
                                
                                <strong>Database Update:</strong><br>
                                ‚Ä¢ <code>UPDATE playbook_access SET expiration_date = NOW() + 90 days WHERE email = ?</code><br>
                                ‚Ä¢ Log transaction in <code>transaction_log</code> table with type="extension"<br><br>
                                
                                <strong>Brevo API Update:</strong><br>
                                ‚Ä¢ Update contact attribute <code>EXPIRATION_DATE</code> = new date<br>
                                ‚Ä¢ Trigger Template #10 with <code>params.newExpirationDate</code><br><br>
                                
                                <strong>Important:</strong> New expiration is 90 days from extension purchase date, not from old expiration (customer doesn't lose days if renewing early)
                            </div>
                        </div>
                    </div>
                </div>
                <div class="timeline-dot">
                    <div class="timeline-circle" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">‚úì</div>
                </div>
                <div class="timeline-spacer"></div>
            </div>
        </div>
        
        <!-- PRICING SUMMARY -->
        <div class="highlight-box">
            <h3>üí∞ Extension Pricing (50% Discount)</h3>
            <p>
                <strong>Essential:</strong> $24.99 for 90 more days (normally $49.99) - 50% savings<br>
                <strong>Professional:</strong> $74.99 for 90 more days (normally $149.99) - save $75<br>
                <strong>Premium:</strong> $124.99 for 90 more days (normally $249.99) - save $125
            </p>
            <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #10b981;">
                <strong>Extension Benefits:</strong><br>
                ‚Ä¢ Immediate access reactivation (if expired) or seamless extension (if active)<br>
                ‚Ä¢ New 90-day access period starts from extension purchase date<br>
                ‚Ä¢ Same great features as original purchase<br>
                ‚Ä¢ Can extend multiple times - discount applies each time<br>
                ‚Ä¢ Simple one-click purchase process<br>
                ‚Ä¢ <strong>Target conversion rate: 40-60% of customers extend access</strong>
            </div>
        </div>
        
        <!-- SUMMARY -->
        <div style="background: linear-gradient(135deg, #374151 0%, #6b7280 100%); color: white; border-radius: 16px; padding: 50px; text-align: center; margin: 60px 0 40px;">
            <div style="font-size: 48px; margin-bottom: 20px;">‚ú®</div>
            <h2 style="color: white; margin: 0 0 20px; border: none; padding: 0;">Complete Customer Journey</h2>
            <p style="font-size: 18px; opacity: 0.95; max-width: 800px; margin: 0 auto;">
                From purchase to delivery to upsells to renewal ‚Äî every touchpoint is automated to maximize value for customers while driving revenue growth.
            </p>
        </div>
        
        <!-- MFC Footer -->
        <div style="background-color: #1e293b; color: #94a3b8; padding: 40px; border-radius: 12px; margin-top: 60px; text-align: center; font-size: 14px;">
            <div style="font-size: 22px; font-weight: 700; color: #ffffff; margin-bottom: 20px;">MyFairClaim</div>
            <p style="margin: 10px 0; line-height: 1.8;">
                Professional Diminished Value Claims Service<br>
                PO Box 125, Scottsdale, AZ 85257<br>
                Phone: <a href="tel:877-503-3247" style="color: #60a5fa; text-decoration: none;">877-503-3247</a><br>
                Email: <a href="/cdn-cgi/l/email-protection#b7c4c2c7c7d8c5c3f7daced1d6dec5d4dbd6deda99d4d8da" style="color: #60a5fa; text-decoration: none;"><span class="__cf_email__" data-cfemail="e3909693938c9197a38e9a85828a91808f828a8ecd808c8e">[email&#160;protected]</span></a><br>
                Website: <a href="https://myfairclaim.com" style="color: #60a5fa; text-decoration: none;">myfairclaim.c